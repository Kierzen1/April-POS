{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { withAuth } from \"next-auth/middleware\"\r\nimport { NextResponse } from \"next/server\"\r\n\r\nexport default withAuth(\r\n    function middleware(req) {\r\n        const token = req.nextauth.token\r\n        const isAuth = !!token\r\n        const path = req.nextUrl.pathname\r\n\r\n        // If not authenticated, the middleware handles the redirect to /login automatically (due to secret presence)\r\n\r\n        if (isAuth) {\r\n            // 1. Check Activation\r\n            if (!token.isActive && path !== \"/waiting-activation\" && path !== \"/logout\") {\r\n                return NextResponse.redirect(new URL(\"/waiting-activation\", req.url))\r\n            }\r\n\r\n            // 2. Prevent active users from seeing the waiting page\r\n            if (token.isActive && path === \"/waiting-activation\") {\r\n                return NextResponse.redirect(new URL(\"/pos\", req.url))\r\n            }\r\n\r\n            // 3. Admin-only routes\r\n            if (path.startsWith(\"/admin\") && token.role !== \"ADMIN\") {\r\n                return NextResponse.redirect(new URL(\"/pos\", req.url))\r\n            }\r\n\r\n            // 4. Staff-only routes (if any specific ones exist, currently POS is for all)\r\n        }\r\n    },\r\n    {\r\n        callbacks: {\r\n            authorized: ({ token }) => !!token,\r\n        },\r\n    }\r\n)\r\n\r\nexport const config = {\r\n    matcher: [\r\n        \"/pos/:path*\",\r\n        \"/admin/:path*\",\r\n        \"/waiting-activation\",\r\n    ],\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;;;uCAEe,IAAA,8JAAQ,EACnB,SAAS,WAAW,GAAG;IACnB,MAAM,QAAQ,IAAI,QAAQ,CAAC,KAAK;IAChC,MAAM,SAAS,CAAC,CAAC;IACjB,MAAM,OAAO,IAAI,OAAO,CAAC,QAAQ;IAEjC,6GAA6G;IAE7G,IAAI,QAAQ;QACR,sBAAsB;QACtB,IAAI,CAAC,MAAM,QAAQ,IAAI,SAAS,yBAAyB,SAAS,WAAW;YACzE,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,uBAAuB,IAAI,GAAG;QACvE;QAEA,uDAAuD;QACvD,IAAI,MAAM,QAAQ,IAAI,SAAS,uBAAuB;YAClD,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,QAAQ,IAAI,GAAG;QACxD;QAEA,uBAAuB;QACvB,IAAI,KAAK,UAAU,CAAC,aAAa,MAAM,IAAI,KAAK,SAAS;YACrD,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,QAAQ,IAAI,GAAG;QACxD;IAEA,8EAA8E;IAClF;AACJ,GACA;IACI,WAAW;QACP,YAAY,CAAC,EAAE,KAAK,EAAE,GAAK,CAAC,CAAC;IACjC;AACJ;AAGG,MAAM,SAAS;IAClB,SAAS;QACL;QACA;QACA;KACH;AACL"}}]
}